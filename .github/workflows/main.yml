name: CI/CD

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:

  build:

    runs-on: ubuntu-latest

    strategy:
          matrix:
            node-version: [ 14.x]
            
    steps:
        - uses: actions/checkout@v2
        - uses: actions/setup-node@v2
          with:
            node-version: '14'
        - name: Install Dependencies
          run: npm ci 
        
        - name: Build React App
          run: npm run build
          
        - name: Deploy
          run: |
            git config --global user.name $user_name
            git config --global user.email $user_email
            git remote set-url origin https://${github_token}@github.com/${repository}
            npm run deploy
          env:
            user_name: 'github-actions[bot]'
            user_email: 'github-actions[bot]@users.noreply.github.com'
            github_token: ${{ secrets.ACTIONS_DEPLOY_ACCESS_TOKEN }}
            repository: ${{ github.repository }}
        

      # Runs a set of commands using the runners shell
      - name: Run a multi-line script
        run: |
          echo Add other actions to build,
          echo test, and deploy your project.
